---
layout: default
---

<article class="library-essay">
  <nav class="library-essay__breadcrumb">
    <a href="{{ '/library/' | relative_url }}" class="library-essay__breadcrumb-link">Library</a>
    <span class="library-essay__breadcrumb-separator">›</span>
    {% assign topic_path = page.url | split: '/' | slice: 0, 4 | join: '/' | append: '/' %}
    {% assign topic_page = site.pages | where: "url", topic_path | first %}
    {% if topic_page %}
      <a href="{{ topic_page.url | relative_url }}" class="library-essay__breadcrumb-link">{{ topic_page.title }}</a>
      <span class="library-essay__breadcrumb-separator">›</span>
    {% endif %}
    <span class="library-essay__breadcrumb-current">{{ page.title }}</span>
  </nav>

  <header class="library-essay__header">
    <h1 class="library-essay__title">{{ page.title }}</h1>
  </header>

  <div class="library-essay__content prose">
    {{ content }}
  </div>

  <nav class="library-essay__navigation">
    {% assign topic_folder = page.url | split: '/' | slice: 1, 3 | join: '/' %}
    {% assign all_essays = site.pages | where_exp: "page", "page.url contains topic_folder" | where_exp: "page", "page.layout == 'library_essay'" | sort: "order" %}
    
    {% assign current_index = 0 %}
    {% for essay in all_essays %}
      {% if essay.url == page.url %}
        {% assign current_index = forloop.index0 %}
        {% break %}
      {% endif %}
    {% endfor %}
    
    <div class="library-essay__nav-links">
      {% assign prev_index = current_index | minus: 1 %}
      {% assign next_index = current_index | plus: 1 %}
      
      {% if prev_index >= 0 %}
        {% assign prev_essay = all_essays[prev_index] %}
        <a href="{{ prev_essay.url | relative_url }}" class="library-essay__nav-link library-essay__nav-link--prev">
          ← {{ prev_essay.title }}
        </a>
      {% endif %}
      
      {% if next_index < all_essays.size %}
        {% assign next_essay = all_essays[next_index] %}
        <a href="{{ next_essay.url | relative_url }}" class="library-essay__nav-link library-essay__nav-link--next">
          {{ next_essay.title }} →
        </a>
      {% endif %}
    </div>

    <div class="library-essay__back-to-topic">
      {% assign topic_path = page.url | split: '/' | slice: 0, 4 | join: '/' | append: '/' %}
      {% assign topic_page = site.pages | where: "url", topic_path | first %}
      {% if topic_page %}
        <a href="{{ topic_page.url | relative_url }}" class="library-essay__topic-link">
          📚 Back to {{ topic_page.title }}
        </a>
      {% endif %}
    </div>
  </nav>
</article>